{% extends 'base.html' %}

{% block title %}Data Testing{% endblock %}

{% block content %}
<div class="container mt-5">
     <div class="table-responsive-sm table-responsive-md">
          <h2 class="mb-3">Data Testing</h2>
          <form action="/test-label" method="post" enctype="multipart/form-data">
               <div class="col-md-6 col-sm-6">
                    <label for="file" class="form-label">Upload CSV File</label>
                    <input type="file" class="form-control" id="file" name="file" accept=".csv" required>
                    <button type="submit" class="btn btn-dark my-3">Upload</button>
               </div>
          </form>
          <!-- <p>Total Data Testing: {{total_data}}</p> -->

          {% if labeled_data %}
          <table class="table table-bordered table-responsive-md table-responsive-sm">
               <thead>
                    <tr>
                         <th>#</th>
                         <th>Full Text</th>
                         <th>Categories</th>
                    </tr>
               </thead>
               <tbody>
                    {% for item in labeled_data %}
                    <tr>
                         <td scope="row">{{ loop.index + (current_page - 1) * 20 }}</td>
                         <td>{{ item.full_text }}</td>
                         <td><strong>{{ item.categories }}</strong></td>
                    </tr>
                    {% endfor %}
               </tbody>
          </table>
          {% else %}
          <p>No data available</p>
          {% endif %}
     </div>

     <!-- Show image -->
     <!-- <img src="{{ url_for('static', filename='images/bar_chart.png')}}" alt="bar chart" /> -->

     <!-- Pagination -->
     {% if total_pages > 1 %}
     <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
               <li class="page-item {% if current_page <= 1 %}disabled{% endif %}">
                    <a class="page-link"
                         href="{{ url_for('labeling.get_data_testing', page=current_page-1) }}">Previous</a>
               </li>
               {% for p in pagination_range %}
               <li class="page-item {% if current_page == p %}active{% endif %}">
                    <a class="page-link" href="{{ url_for('labeling.get_data_testing', page=p) }}">{{ p }}</a>
               </li>
               {% endfor %}
               <li class="page-item {% if current_page >= total_pages %}disabled{% endif %}">
                    <a class="page-link" href="{{ url_for('labeling.get_data_testing', page=current_page+1) }}">Next</a>
               </li>
          </ul>
     </nav>
     {% endif %}

     <h3>Chart Data Testing</h3>
     <!-- Hidden inputs to pass data to JavaScript -->
     <input type="hidden" id="total_positif" value="{{ total_positif }}">
     <input type="hidden" id="total_negatif" value="{{ total_negatif }}">
     <input type="hidden" id="total_netral" value="{{ total_netral }}">

     <!-- Display chart -->
     <div class="mt-5">
          <canvas id="dataChart"></canvas>
     </div>
</div>

{% endblock %}